<div class="set-builder">
    <form class="set-builder__form">
        {% for type in tunes.types %}
            <select class="set-builder__tune-selector">
                <option value=""> --- pick a {{ type }} --- </option>
                {% for tune in tunes.tunes[type] %}
                <option value="{{ tune.get('_id') }}">{{ tune.get('name') }} ({{ tune.get('keys') }})</option>
                {% endfor %}
            </select>
        {% endfor %}
        {% if set.tunes.length %}
            <ol>
                {% for tuneIndex, tune in set.tunes %}
                <li data-tune-id="{{ tune._id }}">{{ tune.name }}
                    {% if tune.keys.length > 1 %}
                        <select class="set-builder__tune__key-selector">
                            {% for key in tune.keys %}
                            <option value="{{ key }}" {% if key === set.keys[tuneIndex] %} selected {% endif %}>{{ key }}</option>
                            {% endfor %}
                        </select>
                    {% else %}
                        {{ tune.keys[0] }}
                    {% endif %}
                </li>
                {% endfor %}
            </ol>
            <input class="set-builder__set-name" value="{{set.name}}">

            <input type="submit" value="save set">
        {% endif %}
    </form>
</div>